CREATE DATABASE IF NOT EXISTS cred_potential;

USE cred_potential;

DROP TABLE IF EXISTS daily_trx;

CREATE TABLE daily_trx
(
    `client_dk` int NOT NULL,
    `Trx_id`    int not NULL PRIMARY KEY,
    `Trx_dt`    date DEFAULT NULL,
    `Trx_amt`   int DEFAULT NULL,
    `Trx_type`  varchar(1) DEFAULT NULL,
    `Merch_id`  int DEFAULT NULL
);

INSERT INTO daily_trx
VALUES (507851886, 165745, '2019-02-02', 6400,   'C', 8234),
       (267188214, 782456, '2019-03-03', 13200,  'C', 10454),
       (267188214, 575631, '2019-05-14', 350000, 'С', 10454),
       (267188214, 575632, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575633, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575634, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575635, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575636, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575637, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575638, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575639, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575640, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575641, '2019-06-15', 350000, 'C', 10454),
       (267188214, 575642, '2019-06-15', 350000, 'C', 10454),
       (148849526, 575643, '2019-07-14', 35000, 'D', 10454),
       (613898474, 783143, '2019-01-05', 61000, 'C', 10454),
       (613898474, 783144, '2019-01-06', 59000, 'C', 8234),
       (613898474, 783145, '2019-01-01', 61000, 'C', 8234),
       (613898474, 783146, '2019-01-02', 61000, 'C', 8234),
       (613898474, 783126, '2019-01-03', 61000, 'C', 8234),
       (613898474, 783127, '2019-01-04', 61000, 'C', 8234),
       (613898474, 783128, '2019-01-05', 61000, 'C', 8234),
       (613898474, 783129, '2019-01-06', 61000, 'C', 8234),
       (613898474, 783130, '2019-01-07', 61000, 'C', 8234),
       (613898474, 783131, '2019-01-08', 61000, 'C', 8234),
       (613898474, 783132, '2019-01-09', 61000, 'C', 8234),
       (613898474, 783133, '2019-01-10', 61000, 'C', 8234),
       (613898474, 783134, '2019-01-11', 61000, 'C', 8234),
       (613898474, 783135, '2019-01-12', 61000, 'C', 8234),
       (613898474, 783136, '2019-01-13', 61000, 'C', 8234);

DROP TABLE IF EXISTS merchant_info;

CREATE TABLE merchant_info
(
    `Merch_id`        int NOT NULL primary key,
    `Mcc_code`        int DEFAULT NULL,
    `Mcc_name`        varchar(100) DEFAULT NULL
);

INSERT INTO merchant_info
VALUES (8234, 15, 'Продукты'),
       (10454, 2, 'Снятие наличных в банкомате'),
       (35475, 33, 'Заработная плата'),
       (262343, 12, 'Снятие наличных в кассе');

DROP TABLE IF EXISTS cred_potential;

CREATE TABLE cred_potential
(
    `client_dk`   int NOT NULL PRIMARY KEY,
    `Crd_potential` int DEFAULT NULL
);

INSERT INTO cred_potential
VALUES (507851886, 100000),
       (267188214, 250000),
       (148849526, 1000000),
       (613898474, 50000);