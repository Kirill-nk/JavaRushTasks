
### task0532

Даны 3 витрины (daily_trx, merchant_info, cred_potential), которые содержат:
• daily_trx – дневные данные по транзакциям клиента с 2018 года
• merchant_info – справочник точки совершения операции (продукты, спорт, АТМ)
• cred_potential - данные о кредитном потенциале клиента (сумма кредитных средств, которую банк готов предложить клиенту)

Схема и пример данных - daily_trx
daily_trx
client_dk	Идентификатор клиента	number	Pk
Trx_id	Идентификатор транзакции	number	
Trx_dt	Дата транзакции	date	
Trx_amt	Сумма транзакции	number	
Trx_type	Тип транзакции (C – расходная, D – приходная)	VARCHAR(1)	
Merch_id	Точки совершения операции	number	Sk

client_dk	Trx_id	Trx_dt	Trx_amt	Trx_type	Merch_id

507 851 886 | 165745 | 02.02.2019	6400	C	8234
267 188 214 | 7821   | 03.03.2019	13200	C	10454
148 849 526 | 575631 | 14.05.2019	35000	D	35475
613 898 474 | 783123 | 05.01.2019	61000	C	262343

Схема и пример данных  - merchant_info
merchant_info
Merch_id	Точки совершения операции	number	Pk
Mcc_code	Код типа магазина -  продукты, спорт и т.д.	number	
Mcc_name	Название типа магазина -  продукты, спорт и т.д.	Varchar(100)	

Merch_id	Mcc_code	Mcc_name
8234	15	Продукты
10454	2	Снятие наличных в банкомате
35475	33	Заработная плата
262343	12	Снятие наличных в кассе

Схема и пример данных  - cred_potential
cred_potential
client_dk	Идентификатор клиента	number	Pk
Crd_potential	Сумма кредитных средств, которую банк готов предложить клиенту	number	

client_dk	Crd_potential
507 851 886	100000
267 188 214	250000
148 849 526	1000000
613 898 474	50000


Необходимо:
1)	По каждому клиенту найти кол-во дней (с начала 2019г. до конца июня 2019г.), которое ему потребовалось, чтобы совершить транзакций (расходных операций) на сумму не меньшую, чем его кредитный потенциал. Если он так и не потратил его, то вывести по клиенту значение = 200
2)	Все то же самое, но теперь учитывать только транзакции в подгруппах mcc кодов, в названиях которых содержится слово «снятие»

Бизнес-кейс
Заказчик просит выделить в клиентской базе Банка клиентов, которых можно привлечь в экосистему Банка (Самокат, Сбермаркет). 
Определить  признаки, которые помогут найти «склонных» клиентов.
